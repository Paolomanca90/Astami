@using Microsoft.AspNetCore.Identity
@inject SignInManager<ApplicationUser> SignInManager
@inject UserManager<ApplicationUser> UserManager

@if (SignInManager.IsSignedIn(User))
{
    <!-- User Menu quando è loggato -->
    <div class="dropdown dropdown-end">
        <div tabindex="0" role="button" class="btn btn-ghost btn-circle avatar">
            <div class="w-10 rounded-full bg-astami-orange text-primary-content items-center justify-center" style="display: flex;">
                <i class="fas fa-user"></i>
            </div>
        </div>
        <ul tabindex="0" class="menu menu-sm dropdown-content bg-base-100 rounded-box z-[1] mt-3 w-60 p-2 shadow-lg border text-gray-500 dark:text-gray-300">
            <li class="menu-title">
                <span>Ciao, @(ViewBag.Nome ?? "Utente")</span>
            </li>
            <li>
                <a asp-area="Identity" asp-page="/Account/Manage/Index" class="font-medium">
                    <i class="fas fa-user-cog mr-2"></i>
                    Il Mio Profilo
                </a>
            </li>
            <li>
                <a href="#" class="font-medium">
                    <i class="fas fa-heart mr-2"></i>
                    Preferiti
                </a>
            </li>
            <li>
                <a href="#" class="font-medium">
                    <i class="fas fa-history mr-2"></i>
                    Le Mie Aste
                </a>
            </li>
            <li>
                <a href="#" class="font-medium">
                    <i class="fas fa-bell mr-2"></i>
                    Notifiche
                    <div class="badge badge-primary badge-sm">3</div>
                </a>
            </li>
            <div class="divider my-1"></div>
            <li>
                <form asp-area="Identity" asp-page="/Account/Logout" asp-route-returnUrl="@Url.Action("Index", "Home", new { area = "" })" method="post" class="w-full">
                    <button type="submit" class="w-full text-left font-medium text-error cursor-pointer">
                        <i class="fas fa-sign-out-alt mr-2"></i>
                        Logout
                    </button>
                </form>
            </li>
        </ul>
    </div>
}
else
{
    <!-- Auth buttons quando non è loggato -->
    <div class="flex gap-2">
        <a asp-area="Identity" asp-page="/Account/Login" class="btn btn-ghost font-medium">
            <i class="fas fa-sign-in-alt mr-2"></i>
            Accedi
        </a>
        <a asp-area="Identity" asp-page="/Account/Register" class="btn btn-astami-orange font-medium shadow-astami-dark-orange">
            <i class="fas fa-user-plus mr-2"></i>
            Registrati
        </a>
    </div>
}